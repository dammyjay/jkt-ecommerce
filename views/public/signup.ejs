<section class="auth-section">
  <div class="auth-container">
    <div class="auth-box">
      <h2>Create Account</h2>

      <!-- <form id="signupForm" action="/auth/signup" method="POST">
        <div class="input-group">
          <input type="text" name="fullname" placeholder="Full Name" required />
        </div>

        <div class="input-group">
          <input
            type="email"
            name="email"
            id="emailField"
            placeholder="Email"
            required
          />
        </div>

        <div class="input-group">
          <input
            type="password"
            name="password"
            placeholder="Password"
            required
          />
        </div>

        <button type="submit" class="btn">Sign Up</button>
      </form> -->

      <form
        id="signupForm"
        action="/auth/signup"
        method="POST"
        enctype="multipart/form-data"
      >
        <div class="input-group">
          <input type="text" name="fullname" placeholder="Full Name" required />
        </div>

        <div class="input-group">
          <input
            type="email"
            name="email"
            id="emailField"
            placeholder="Email"
            required
          />
        </div>

        <div class="input-group">
          <input
            type="password"
            name="password"
            placeholder="Password"
            required
          />
        </div>

        <div class="input-group">
          <label for="profileImage">Upload Profile Image</label>
          <input type="file" name="profileImage" accept="image/*" />
        </div>

        <button type="submit" class="btn">Sign Up</button>
      </form>

      <div class="social-login">
        <p>Or continue with</p>
        <div class="social-buttons">
          <a href="/auth/google" class="google-btn">Google</a>
          <a href="/auth/facebook" class="facebook-btn">Facebook</a>
          <a href="/auth/linkedin" class="linkedin-btn">LinkedIn</a>
        </div>
      </div>

      <p class="note">
        Already have an account? <a href="/auth/login">Login</a>
      </p>
    </div>
  </div>

  <!-- OTP Modal -->
  <div id="otpModal" class="modal">
    <div class="modal-content">
      <span id="closeModal">&times;</span>
      <h3>Email Verification</h3>
      <p>Weâ€™ve sent an OTP to your email. Please verify below.</p>

      <form id="otpForm" action="/auth/verifyOtp" method="POST">
        <input type="email" name="email" id="otpEmail" readonly /> <br />
        <input
          type="text"
          name="otp"
          placeholder="Enter OTP"
          maxlength="6"
          required
        />
        <button type="submit" class="btn">Verify</button>
      </form>

      <p id="otpMessage"></p>
    </div>
  </div>
<!-- Loading Overlay -->
<div id="loadingOverlay">
  <div class="loader-container">
    <!-- Custom loading image -->
    <img src="/images/JKT logo.png" alt="Loading..." class="loader-img" />
    <p>Signing you up...</p>
  </div>
</div>

<!-- <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const signupForm = document.getElementById("signupForm");
  const otpModal = document.getElementById("otpModal");
  const otpEmail = document.getElementById("otpEmail");
  const emailField = document.getElementById("emailField");
  const loadingOverlay = document.getElementById("loadingOverlay");

  // ðŸŸ¢ Signup form submit
  signupForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    // Show loading icon
    loadingOverlay.style.display = "flex";

    try {
      const formData = new FormData(signupForm);
      const res = await fetch("/auth/signup", {
        method: "POST",
        body: formData,
      });

      // Hide loader when response is received
      loadingOverlay.style.display = "none";

      if (res.ok) {
        otpModal.style.display = "flex";
        otpEmail.value = emailField.value;
      } else {
        const errorText = await res.text();
        Swal.fire({
          icon: "error",
          title: "Signup Failed",
          text: errorText || "Something went wrong. Please try again.",
        });
      }
    } catch (err) {
      loadingOverlay.style.display = "none";
      Swal.fire({
        icon: "error",
        title: "Network Error",
        text: "Unable to connect to the server. Please check your internet.",
      });
    }
  });

  // ðŸŸ¢ Close OTP modal
  document.getElementById("closeModal").onclick = () => {
    otpModal.style.display = "none";
  };

  // ðŸŸ¢ Close modal when clicking outside it
  window.onclick = (e) => {
    if (e.target === otpModal) {
      otpModal.style.display = "none";
    }
  };
otpForm.addEventListener("submit", async (e) => {
  e.preventDefault();

  const email = document.getElementById("otpEmail").value;
  const otp = e.target.otp.value;

  const res = await fetch("/auth/verifyOtp", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, otp }), // âœ… send JSON
  });

  const data = await res.json();
  const msgEl = document.getElementById("otpMessage");

  if (data.success) {
    Swal.fire({
      icon: "success",
      title: "Email Verified!",
      text: "You can now log in to your account.",
      showConfirmButton: false,
      timer: 2000,
    });
    setTimeout(() => (window.location.href = "/auth/login"), 2000);
  } else {
    msgEl.style.color = "#dc2626";
    msgEl.textContent = data.message;
  }
});

</script> -->

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  const signupForm = document.getElementById("signupForm");
  const otpForm = document.getElementById("otpForm");
  const otpModal = document.getElementById("otpModal");
  const otpEmail = document.getElementById("otpEmail");
  const emailField = document.getElementById("emailField");
  const loadingOverlay = document.getElementById("loadingOverlay");

  // ðŸŸ¢ Signup form submit
  signupForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    // Show loading icon
    loadingOverlay.querySelector("p").textContent = "Signing you up...";
    loadingOverlay.style.display = "flex";

    try {
      const formData = new FormData(signupForm);
      const res = await fetch("/auth/signup", {
        method: "POST",
        body: formData,
      });

      // Hide loader once response is received
      loadingOverlay.style.display = "none";

      if (res.ok) {
        otpModal.style.display = "flex";
        otpEmail.value = emailField.value;
      } else {
        const errorText = await res.text();
        Swal.fire({
          icon: "error",
          title: "Signup Failed",
          text: errorText || "Something went wrong. Please try again.",
        });
      }
    } catch (err) {
      loadingOverlay.style.display = "none";
      Swal.fire({
        icon: "error",
        title: "Network Error",
        text: "Unable to connect to the server. Please check your internet.",
      });
    }
  });

  // ðŸŸ¢ OTP form submit
  otpForm.addEventListener("submit", async (e) => {
    e.preventDefault();

    // Show loading overlay while verifying OTP
    loadingOverlay.querySelector("p").textContent = "Verifying OTP...";
    loadingOverlay.style.display = "flex";

    const email = otpEmail.value;
    const otp = e.target.otp.value;

    try {
      const res = await fetch("/auth/verifyOtp", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ email, otp }),
      });

      const data = await res.json();

      // Hide loading overlay
      loadingOverlay.style.display = "none";

      if (data.success) {
        Swal.fire({
          icon: "success",
          title: "Email Verified!",
          text: "You can now log in to your account.",
          showConfirmButton: false,
          timer: 2000,
        });
        setTimeout(() => (window.location.href = "/auth/login"), 2000);
      } else {
        const msgEl = document.getElementById("otpMessage");
        msgEl.style.color = "#dc2626";
        msgEl.textContent = data.message;
      }
    } catch (error) {
      loadingOverlay.style.display = "none";
      Swal.fire({
        icon: "error",
        title: "Verification Failed",
        text: "Something went wrong. Please try again.",
      });
    }
  });

  // ðŸŸ¢ Close OTP modal
  document.getElementById("closeModal").onclick = () => {
    otpModal.style.display = "none";
  };

  // ðŸŸ¢ Close modal when clicking outside it
  window.onclick = (e) => {
    if (e.target === otpModal) {
      otpModal.style.display = "none";
    }
  };
</script>


</section>
